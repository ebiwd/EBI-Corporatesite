<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>The European Bioinformatics Institute &lt; EMBL-EBI</title>
  <meta name="description" content="EMBL-EBI" /><!-- Describe what this page is about -->
  <meta name="keywords" content="bioinformatics, europe, institute" /><!-- A few keywords that relate to the content of THIS PAGE (not the whol project) -->
  <meta name="author" content="EMBL-EBI" /><!-- Your [project-name] here -->
  <meta name="HandheldFriendly" content="true" />
  <meta name="MobileOptimized" content="width" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#70BDBD" /> <!-- Android Chrome mobile browser tab color -->

  <!-- Add information on the life cycle of this page -->
  <meta name="ebi:owner" content="Web Content Committee" /> <!-- Who should be contacted about changes -->
  <meta name="ebi:review-cycle" content="90" /> <!-- In days, how often should the content be reviewed -->
  <meta name="ebi:last-review" content="2017-05-02" /> <!-- The last time the content was reviewed -->
  <meta name="ebi:expiry" content="2017-06-20" /> <!-- When this content is no longer relevant -->

  <link rel="icon" type="image/x-icon" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/favicon.ico" />
  <link rel="icon" type="image/png" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="192Ã—192" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/android-chrome-192x192.png" /> <!-- Android (192px) -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/apple-icon-114x114.png" /> <!-- For iPhone 4 Retina display (114px) -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/apple-icon-72x72.png" /> <!-- For iPad (72px) -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/apple-icon-144x144.png" /> <!-- For iPad retinat (144px) -->
  <link rel="apple-touch-icon-precomposed" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/apple-icon-57x57.png" /> <!-- For iPhone (57px) -->
  <link rel="mask-icon" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/safari-pinned-tab.svg" color="#ffffff" /> <!-- Safari icon for pinned tab -->
  <meta name="msapplication-TileColor" content="#2b5797" /> <!-- MS Icons -->
  <meta name="msapplication-TileImage" content="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/favicons/mstile-144x144.png" />

  <link rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/libraries/foundation-6/css/foundation.min.css" type="text/css" media="all" />
  <link rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/css/ebi-global.min.css" type="text/css" media="all" />
  <link rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/EBI-Icon-fonts/v1.2/fonts.css" type="text/css" media="all" />
</head>

<body class="level2"><!-- add any of your classes or IDs -->
  <div id="skip-to">
    <ul>
      <li><a href="#content">Skip to main content</a></li>
      <li><a href="#local-nav">Skip to local navigation</a></li>
      <li><a href="#global-nav">Skip to EBI global navigation menu</a></li>
      <li><a href="#global-nav-expanded">Skip to expanded EBI global navigation menu (includes all sub-sections)</a></li>
    </ul>
  </div>
  <header id="masthead-black-bar" class="clearfix masthead-black-bar">
    <nav class="row">
      <ul id="global-nav" class="menu">
        <!-- set active class as appropriate -->
        <li class="home-mobile"><a href="//www.ebi.ac.uk"></a></li>
        <li class="home active"><a href="//www.ebi.ac.uk"></a></li>
        <li class="services"><a href="//www.ebi.ac.uk/services">Services</a></li>
        <li class="research"><a href="//www.ebi.ac.uk/research">Research</a></li>
        <li class="training"><a href="//www.ebi.ac.uk/training">Training</a></li>
        <li class="about"><a href="//www.ebi.ac.uk/about">About us</a></li>
        <li class="search">
          <a href="#" data-toggle="search-global-dropdown"><span class="show-for-small-only">Search</span></a>
          <div id="search-global-dropdown" class="dropdown-pane" data-dropdown data-options="closeOnClick:true;">
          <!-- The dropdown menu will be programatically added by script.js -->
          </div>
        </li>
        <li class="float-right show-for-medium embl-selector">
          <button class="button float-right" type="button" data-toggle="embl-dropdown">Hinxton</button>
          <!-- The dropdown menu will be programatically added by script.js -->
        </li>
      </ul>
    </nav>
  </header>
  <div data-sticky-container>
    <div id="masthead" class="masthead" data-sticky data-sticky-on="disabled" data-top-anchor="content:top" data-btm-anchor="content:bottom">
      <header>
        <div class="masthead-inner padding-top-none">
          <!-- local-title -->
          <div class="" id="local-title">
            <div class="masthead-content">
              <div class="row">
                <div class="columns medium-3 white-color">
                  <div class="margin-top-xlarge padding-top-xlarge"><!--spacer--></div>
                  <img src="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/images/logos/EMBL-EBI/EMBL_EBI_Logo_white.svg" style="width:300px;position:relative;z-index: 5;">
                  <p>The home for big data in biology</p>
                  <div class="small show-for-medium visulisation-legend medium-12 large-2">
                    Visualisation: EBI Search is an index of biological resources, sites, and enables scientific queries. <a href="//www.ebi.ac.uk/ebisearch/overview.ebi" class="readmore">Learn more</a>
                  </div>
                  <div class="show-for-large margin-bottom-xlarge"><!--spacer--></div>
                </div>
                <div class="columns show-for-medium medium-9" style="position: relative; z-index: 3; overflow: hidden;">
                  <!-- iFrame data vis to be inserted here -->
                  <div id="visulisation-parent" class="medium-7 large-12 visulisation"></div>
                  <style type="text/css">
                  .masthead { background: #111;}
                  .visulisation, .visulisation iframe { border:0; width: 800px; height: 315px; overflow: hidden; }
                  @media screen and (min-width: 64em) {
                    .visulisation {
                      float: right;
                    }
                    .visulisation-legend {
                      position: absolute; z-index: 5;right: 1%; top: 2.5rem;
                    }
                  }
                  @media screen and (max-width: 64em) {
                    .visulisation-legend {
                      float: left;
                    }
                    .visulisation iframe {
                      -moz-transform-origin: 0 0;
                      -o-transform-origin: 0 0;
                      -webkit-transform-origin: 0 0;
                      -ms-zoom: 0.85;
                      -moz-transform: scale(0.85);
                      -o-transform: scale(0.85);
                      -webkit-transform: scale(0.85);
                    }
                  }
                  </style>
                </div>
              </div>
              <div class="row padding-top-xlarge padding-bottom-xlarge">
                <div class="columns small-12 large-7 medium-6">
                  <span class="label show-for-small-only white-color">EBI Search</span>
                  <p class="show-for-medium">Our unique Search service helps you explore dozens of biological data resources. <span class="show-for-large inline-block"><a class="readmore" href="//www.ebi.ac.uk/ebisearch/overview.ebi">More about EBI Search</a></span>
                  </p>
                  <form id="ebi_search" action="https://www.ebi.ac.uk/ebisearch/search.ebi">
                    <fieldset>
                      <div class="margin-bottom-none small-collapse">
                        <div class="columns small-2 margin-bottom-small search-options-wrapper">
                          <select name="db" id="db" tabindex="1" class="margin-bottom-none" style="opacity: .8;">
                            <option value="allebi">All</option>
                            <optgroup label="Science search">
                              <option value="genomes">Genomes &amp; metagenomes</option>
                              <option value="nucleotideSequences">Nucleotide sequences</option>
                              <option value="proteinSequences">Protein sequences</option>
                              <option value="smallMolecules">Small molecules</option>
                              <option value="geneExpression">Gene expression</option>
                              <option value="molecularInteractions">Molecular interactions</option>
                              <option value="reactionsPathways">Reactions, pathways &amp; diseases</option>
                              <option value="proteinFamilies">Protein families</option>
                              <option value="literature">Literature</option>
                              <option value="ontologies">Samples & ontologies</option>
                            </optgroup>
                            <optgroup label="Search web content">
                              <option value="ebiweb_people">EMBL-EBI People</option>
                              <option value="ebiweb">EMBL-EBI web</option>
                              <!-- <option value="ebiweb">EMBL web</option> -->
                            </optgroup>
                          </select>
                        </div>
                        <div class="columns small-8  margin-bottom-none search-text-wrapper">
                          <input id="query" class="margin-bottom-none" title="EBI Search" tabindex="2" type="text" name="query" value="" size="35" maxlength="2048" placeholder="Find a gene, protein or chemical"/>
                        </div>
                        <div class="columns small-2 margin-bottom-none">
                          <input id="search_submit" class="button icon icon-functional margin-bottom-none" tabindex="3" type="submit" name="submit1" value="1" style="line-height:.9"/>
                        </div>
                        <!-- <input id="allebi" type="hidden" name="db" value="allebi" checked="checked" /> -->
                        <input type="hidden" name="requestFrom" value="ebi_index" />
                      </div>
                    </fieldset>
                    <fieldset>
                      <div id="example" class="medium-push-2 medium-10 columns small">
                        Example searches: <a href="/ebisearch/search.ebi?db=allebi&amp;requestFrom=ebi_index&amp;query=blast">blast</a> <a href="/ebisearch/search.ebi?db=allebi&amp;query=keratin&amp;requestFrom=ebi_index">keratin</a> <a href="/ebisearch/search.ebi?db=allebi&amp;query=bfl1&amp;requestFrom=ebi_index">bfl1</a>
                      </div>
                    </fieldset>
                  </form>
                </div>
                <div class="columns large-2 medium-3 show-for-medium">
                  <div>
                    <p>Find a tool for your data analysis.</p>
                    <a href="//www.ebi.ac.uk/services/" class="button readmore" style="border-bottom: none;line-height: .9;"><i class="icon icon-generic" data-icon="("></i> Find a tool</a>
                  </div>
                </div>
                <div class="columns large-3 medium-3 small-6 show-for-medium">
                  <div>
                    <p>Share your scientific data with the world.</p>
                    <a href="//www.ebi.ac.uk/submission/" class="button readmore" style="border-bottom: none;line-height: .9;"><i class="icon icon-functional" data-icon="D"></i> Deposit data</a>
                  </div>
                </div>
                <div class="columns small-12 show-for-small-only padding-top-large">
                  <span class="label show-for-small-only white-color">Access and share data</span>
                  <div>
                    <a href="//www.ebi.ac.uk/services/"   class="button no-underline readmore"  style="border-bottom: none;line-height: .9;"><i class="icon icon-generic" data-icon="("></i> Find a tool</a>
                    <a href="//www.ebi.ac.uk/submission/" class="button no-underline readmore" style="border-bottom: none;line-height: .9;"><i class="icon icon-generic" data-icon="q"></i> Deposit data</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- /local-title -->
        </div>
      </header>
    </div>
  </div>

  <div id="content">
    <section id="main-content-area" class="" role="main">
      <div class="row">
        <div class="small-12 columns margin-bottom-xlarge padding-top-xlarge analytics-content-intro">
          <p>We are part of <a href="http://embl.org/">EMBL</a>, Europeâ€™s flagship laboratory for the life sciences.</p>
          <h3>Explore EMBL-EBI and our mission</h3>
          <p class="intro">The European Bioinformatics Institute (EMBL-EBI) shares <a href="/services">data from life science experiments</a>, performs <a href="/research">basic research</a> in computational biology and offers an extensive <a href="/training">user training</a> programme, supporting researchers in academia and <a href="/industry">industry</a>. <a class="readmore" href="//www.ebi.ac.uk/about/our-impact">More about EMBL-EBI and our impact</a></p>

          <div class=" small-up-2 medium-up-5" data-equalizer>
            <a href="//www.ebi.ac.uk/services" class="column no-underline" data-equalizer-watch>
              <p><h4 class="services-color"><span class="icon icon-generic" data-icon="("></span> <div class="inline-block">Services</div></h4>
              <p>We provide freely available data and bioinformatics services to all facets of the scientific community&nbsp;<i class="icon icon-functional" data-icon=">"></i></p>
              </p>
            </a>
            <a href="//www.ebi.ac.uk/research" class="column no-underline" data-equalizer-watch>
              <p><h4 class="research-color"><span class="icon icon-generic" data-icon=")"></span> <div class="inline-block">Research</div></h4>
              <p>We contribute to the advancement of biology through basic investigator-driven research&nbsp;<i class="icon icon-functional" data-icon=">"></i></p>
              </p>
            </a>
            <a href="//www.ebi.ac.uk/training" class="column no-underline" data-equalizer-watch>
              <p><h4 class="training-color"><span class="icon icon-generic" data-icon="t"></span> <div class="inline-block">Training</div></h4>
              <p>We provide advanced bioinformatics training to scientists at all levels&nbsp;<i class="icon icon-functional" data-icon=">"></i></p>
              </p>
            </a>
            <a href="//www.ebi.ac.uk/industry" class="column no-underline" data-equalizer-watch>
              <p><h4 class="industry-color"><span class="icon icon-generic" data-icon="I"></span> <div class="inline-block">Industry</div></h4>
              <p>We help disseminate cutting-edge technologies to industry&nbsp;<i class="icon icon-functional" data-icon=">"></i></p>
              </p>
            </a>
            <a href="https://www.elixir-europe.org" class="column no-underline" data-equalizer-watch>
              <p><h4 class="elixir-color"><span class="icon icon-generic" data-icon="%"></span> <div class="inline-block">ELIXIR</div></h4>
              <p>We support, as an ELIXIR node, the coordination of biological data provision throughout Europe&nbsp;<i class="icon icon-functional" data-icon=">"></i></p>
              </p>
            </a>
          </div>
        </div>

        <div class="medium-4 columns callout analytics-content-left">
          <h3><a href="//www.ebi.ac.uk/about/news" class="no-underline">Latest news</a></h3>
          <span class="label">Reseach highlights, service updates and more</span>
          <div class="row collapse">
            <div class="with-overlay">
              <!-- <img src="//www.ebi.ac.uk/sites/ebi.ac.uk/files/styles/large/public/groups/external_relations/images/News/EMPIAR_news_21_03_2016_EBI.jpg?itok=Y5aDjbJy" alt="Photo of Uranus."> -->
              <div id="news-lead-item"></div>
            </div>
          </div>

          <div id="news-updates"></div>

          <div class="margin-top-large margin-bottom-xlarge ">
            <a class="readmore button margin-bottom-none" href="//www.ebi.ac.uk/about/news/">Read all EMBL-EBI news</a><br/>
            <a class="readmore small" href="//news.embl.de">News from across EMBL </a><br/>
          </div>
        </div>
        <div class="medium-8 columns analytics-content-right">
          <h3 class="padding-top-large"><a href="//www.ebi.ac.uk/about/events" class="no-underline">Our events</a></h3>
          <div id="upcoming-events">
            <!-- loaded by handlebars -->
          </div>
          <a class="readmore button margin-top-large margin-bottom-xlarge" href="//www.ebi.ac.uk/about/events">See all EMBL-EBI events</a>
        </div>
      </div>
      <div class="row analytics-content-footer">
        <h3 class="show-for-large"><a href="//www.ebi.ac.uk/about" class="readmore no-underline">About EMBL-EBI's culture and impact</a></h3>
        <div class="row large-up-5 medium-up-3 small-up-2 padding-bottom-large " data-equalizer data-equalize-on="small" >
          <div class="column">
            <a href="//www.ebi.ac.uk/about/jobs">
              <img src="//www.ebi.ac.uk/sites/ebi.ac.uk/files/styles/large/public/groups/external_relations/images/Events/all-at-ebi_stepping_down_EBI.jpg" alt="Staff outside Hindton Hall.">
            </a>
            <a href="//www.ebi.ac.uk/about/jobs" class="highlight-caption readmore">Jobs &amp; Careers</a>
          </div>
          <div class="column">
            <a href="//www.ebi.ac.uk/about/jobs/career-profiles">
              <img src="//www.ebi.ac.uk/sites/ebi.ac.uk/files/styles/large/public/groups/external_relations/images/News/Science_Is_Global_2016_EBI_500x375.jpg?itok=mp_IWQhk" alt="Science is Global map at EMBL-EBI.">
            </a>
            <a href="//www.ebi.ac.uk/about/jobs/career-profiles" class="highlight-caption readmore">Life at EMBL-EBI</a>
          </div>
          <div class="column">
            <a href="//www.ebi.ac.uk/about/travel">
              <img src="//www.ebi.ac.uk/sites/ebi.ac.uk/files/styles/large/public/groups/external_relations/images/Events/Stepping_down_bbq_EBI.jpg" alt="Staff at Hinxton Hall.">
            </a>
            <a href="//www.ebi.ac.uk/about/travel" class="highlight-caption readmore">Visit us</a>
          </div>
          <div class="column">
            <a href="//www.ebi.ac.uk/about/our-impact">
              <img src="//www.ebi.ac.uk/sites/ebi.ac.uk/files/styles/large/public/field/image/Data_centre_shutdown_2016.jpg?itok=fy5v2YZu" alt="EMBL-EBI data centre.">
            </a>
            <a href="//www.ebi.ac.uk/about/our-impact" class="highlight-caption readmore">Our impact</a>
          </div>
          <div class="column">
            <a href="//www.ebi.ac.uk/about/people">
              <img src="https://ebiwd.github.io/EBI-Pattern-library/sample-site-v1.2/images/MACDOWELL_Mark_AKEN_Bronwen_2016.jpg" alt="Staff working at EMBL-EBI.">
            </a>
            <a href="//www.ebi.ac.uk/about/people" class="highlight-caption readmore show-for-medium">Find a staff member</a>
            <a href="//www.ebi.ac.uk/about/people" class="highlight-caption readmore show-for-small-only">Find people</a>
          </div>
          <div class="column hide-for-large" >
            <a href="//www.ebi.ac.uk/about">
              <div style="width:100%;" class="">
                <h3><a href="//www.ebi.ac.uk/about" class="readmore"><br/>More about<br/> EMBL-EBI culture<br/> and impact</a></h3>
              </div>
            </a>
          </div>
        </div>
      </div>


    </div>
  </section>
  <footer>
    <div id="global-footer" class="global-footer">
      <nav id="global-nav-expanded" class="global-nav-expanded row">
        <!-- Footer will be automatically inserted by footer.js -->
      </nav>
      <section id="ebi-footer-meta" class="ebi-footer-meta row">
        <!-- Footer meta will be automatically inserted by footer.js -->
      </section>
    </div>
  </footer>
  <!-- JavaScript -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script defer="defer" src="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/js/script.js"></script>
  <!-- include HandlebaRss -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.8/handlebars.min.js"></script>

  <script id="feed-template-news-lead-item" type="text/x-handlebars-template">
    {{#each item}}
      {{#if @first}}
        {{{description}}}
        <div class="caption">
          <a href="{{link}}" class="inner">{{title}}</a>
          <p>{{pubDate}}</p>
        </div>
      {{else}}
        <!-- Only show first -->
      {{/if}}
    {{/each}}
  </script>
  <script id="feed-template-news-updates" type="text/x-handlebars-template">
    {{#each item}}
      <div class="padding-top-medium">
        <span class="label">{{pubDate}}</span>
        <h6><a href="{{link}}">{{title}}</a></h6>
      </div>
    {{/each}}
  </script>
  <script id="template-upcoming-events" type="text/x-handlebars-template">
    {{#each this}}
      <span class="label">{{smartDates this.json.starts.value this.json.starts.value2}}</span>
      <span class="label">| {{this.json.bundle_name}}</span>
      <h5><a href="//www.ebi.ac.uk/{{this.json.path}}">{{this.json.title}}</a></h5>
      <p><a class="no-underline" href="//www.ebi.ac.uk/{{this.json.path}}">{{{truncate this.json.short_description.safe_value 150}}}</a></p>
    {{/each}}
  </script>

  <script type="text/javascript" charset="utf-8">
  document.onreadystatechange = function () {
    if (document.readyState === "complete") {
      // Custom analytics hooks for front page
      // Search box
      jQuery("#ebi_search").on('mousedown', 'input#search_submit', function(e) {
        var customText = 'query: ' + jQuery('#ebi_search input#query').val();
        customText += ' db: ' + jQuery('#ebi_search select#db').val();
        analyticsTrackInteraction(e.target,'Homepage search',customText);
      });

      // Insert data vis
      // We load it only if the div is visible, and schedule a check if not
      function conditionallyLoadDatavis() {
        if ($('#visulisation-parent').is(':visible')) {
          $('#visulisation-parent').html('<iframe src="https://ebiwd.github.io/EBI-Search-index-visulisation/force.html" style="" scrolling="no"></iframe>');
        } else {
          // Check again if the screen resizes
          // We schedule only one check -- if that check fails, we schedule again
          $(window).one('resize.datavischeck', function() {
            conditionallyLoadDatavis();
          });
        }
      }
      conditionallyLoadDatavis();

      // handlebars stuff
      Handlebars.registerHelper('truncate', function (str, len) {
        if (str.length > len) {
          var new_str = str.substr (0, len+1);
          while (new_str.length) {
            var ch = new_str.substr ( -1 );
            new_str = new_str.substr ( 0, -1 );
            if (ch == ' ') { break; }
          }

          if ( new_str == '' ) {
              new_str = str.substr ( 0, len );
          }

          return new Handlebars.SafeString ( new_str +'...' );
        }
        return str;
      });
      function formatDate(date){
        if (typeof(date) == "undefined") { return "Unknown"; }

        date = date.replace(" ","T"); // drupal date format needs a "T"
                        // "2015-10-19 08:15:00" >> "2015-10-19T08:15:00"

        var dateAway = new Date(date),
            date = dateAway.getDate(),
            month = "January,February,March,April,May,June,July,August,September,October,November,December"
          .split(",")[dateAway.getMonth()];

        function nth(d) {
          if(d>3 && d<21) return 'th';
          switch (d % 10) {
            case 1:  return "st";
            case 2:  return "nd";
            case 3:  return "rd";
            default: return "th";
          }
        }
        var weekday = ["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"];
        return weekday[dateAway.getDay()] + " " + date+nth(date) + " " + month.substring(0,3);
      }

      // we want to show a start and end, a la: Oct 16th; Oct 12th-15th, Oct 21st - Nov 1st
      Handlebars.registerHelper("smartDates", function(date1, date2){
        // if start = end, just return the first
        if (date1 == date2) { return formatDate(date1); }
        // Ok, so we have a proper start and end...
        var jointDate = '';
        // are the two dates in the same month?
        if (new Date(date1).getMonth() == new Date(date2).getMonth()) {
          // if it's the same day, don't list the date twice ...
          if (new Date(date1).getDay() == new Date(date2).getDay()) {
            return formatDate(date1);
          }
          //don't return the month on the second date..
          jointDate = formatDate(date1) + ' - ' + formatDate(date2).split(' ')[0] + ' ' + formatDate(date2).split(' ')[1];
          return jointDate;
        }
        // ok, so just tell us it all
        jointDate = formatDate(date1) + ' - ' + formatDate(date2);
        return jointDate;
      });

      // feed processor
      function HandlebaRss(feedUrl,template,destination){
        this.feedUrl = feedUrl;
        this.template = template;
        this.destination = destination;
      }
      HandlebaRss.prototype.init = function(){
        function queryData(properties) {
          $.ajax({
            url: 'https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20rss%20where%20url%3D%22'+ encodeURIComponent(properties.feedUrl)+'%22limit%206&&format=json&diagnostics=false&_maxage=3600',
            template:    properties.template,
            destination: properties.destination
          }).done( function(data) {
            if (data.query.results.item.length > 0) {
              var template = Handlebars.compile($(properties.template).html());
              $(properties.destination).html(template(data.query.results));
            } else {
              // retry if 0 length
              window.setTimeout(queryData(properties), 500);
            }
          });
        }

        queryData(this);
      }

      newsLeadItem = new HandlebaRss("https://www.ebi.ac.uk/about/news/press.xml",  "#feed-template-news-lead-item","#news-lead-item").init();
      newsUpdates =  new HandlebaRss("https://www.ebi.ac.uk/about/news/service.xml","#feed-template-news-updates",  "#news-updates"  ).init();

      // $.getJSON('temp/events-common-fields-feed-upcoming-events.json', function(data) {
      // select json.title, json.bundle_name, json.path, json.short_description, json.starts from json where url='https://www.ebi.ac.uk/sites/ebi.ac.uk/files/data/events-common-fields-feed-upcoming-events.json' limit 6
      // https://developer.yahoo.com/yql/console/?q=select%20*%20from%20html%20where%20url%3D%27http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FYahoo%27%20and%20xpath%3D%27%2F%2Ftable%2F*%5Bcontains(.%2C%22Founder%22)%5D%2F%2Fa%27&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys#h=select+json.title%2C+json.bundle%2C+json.path%2C+json.short_description+from+json+where+url%3D'https%3A%2F%2Fwww.ebi.ac.uk%2Fsites%2Febi.ac.uk%2Ffiles%2Fdata%2Fevents-common-fields-feed-upcoming-events.json'+limit+10
      function getEventData() {
        $.getJSON("https://query.yahooapis.com/v1/public/yql?q=select%20json.title%2C%20json.bundle_name%2C%20json.path%2C%20json.short_description%2C%20json.starts%20from%20json%20where%20url%3D'https%3A%2F%2Fwww.ebi.ac.uk%2Fsites%2Febi.ac.uk%2Ffiles%2Fdata%2Fevents-common-fields-feed-upcoming-events.json'%20limit%206&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&_maxage=1200", function(data) {
          // console.log(data);
          var willRetry = false;
          if (data.query.count == 0) {
            willRetry = true;
          } else {
            data = data.query.results.json; // yql path
            var source = $('#template-upcoming-events').html();
            $('#upcoming-events').html(Handlebars.compile(source)(data));
          }
          if (willRetry) {
            var retrying = window.setTimeout(getEventData(), 1200);
          }
        });
      }
      getEventData();
    }
  }
  </script>

  <!-- GA -->
  <script type="text/javascript">
  <!--//--><![CDATA[//><!--
  (function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create", "UA-629242-1", {"cookieDomain":"auto"});ga("require", "linkid", "linkid.js");ga("set", "anonymizeIp", true);ga("send", "pageview");
  //--><!]]>
  </script>

  <!-- The Foundation theme JavaScript -->
  <script src="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/libraries/foundation-6/js/foundation.min.js"></script>
  <!-- <script src="//www.ebi.ac.uk/web_guidelines/EBI-Framework/v1.2/js/foundationExtendEBI.js"></script> -->
  <script type="text/JavaScript">
  // Temp inline the foundationextend while we model various GA improvements
  /* Copyright (c) EMBL-EBI 2017
     Authors:
     Ken Hawkins (khawkins@ebi.ac.uk)
  */

  // Analytics tracking
  // This code tracks the user's clicks in various parts of the EBI site and logs them as GA events.
  // Links in non-generic regions can be tracked by adding '.track-with-analytics-events' to a parent div. Careful with the scoping.
  //
  // Dev note:
  // add class verbose-analytics to your body for a readout to console on clicks, ala:
  // jQuery('body').addClass('verbose-analytics');
  // -------------
  var ga = ga || [];
  var numberOfEbiGaChecks = 0;
  var numberOfEbiGaChecksLimit = 2;
  var lastGaEventTime = Date.now(); // track the last time an event was send (don't double send)
  function ebiGaCheck() {
    if (ga.loaded) {
      jQuery('body').addClass('google-analytics-loaded'); // Confirm GA is loaded, add a class if found
      ebiGaInit();
    } else {
      if (numberOfEbiGaChecks < numberOfEbiGaChecksLimit) {
        numberOfEbiGaChecks++;
        setTimeout(ebiGaCheck, 900); // give a second check if GA was slow to load
      }
    }
  }
  ebiGaCheck(); // invoke analytics check

  // Utility method
  if (!Array.prototype.last){
    Array.prototype.last = function(){
      return this[this.length - 1];
    };
  };

  function analyticsTrackInteraction(actedOnItem, parentContainer, customEventName) {
    var customEventName = customEventName || []; // you can pass some custom text as a 3rd param

    if (customEventName.length > 0) {
      linkName = customEventName;
    } else { // then derive a value
      var linkName = jQuery(actedOnItem).text().toString();
      // if there's no text, it's probably and image
      if (linkName.length == 0 && jQuery(actedOnItem).attr('src')) linkName = jQuery(actedOnItem).attr('src').split('/').last();
      if (linkName.length == 0 && jQuery(actedOnItem).val()) linkName = jQuery(actedOnItem).val();

      // special things for gloabl search box
      if (parentContainer == 'Global search') {
        linkName = 'query: ' + jQuery('#global-search input#query').val();
      }
    }

    // send to GA
    // Only if more than 100ms has past since last click.
    // Due to our structure, we fire multiple events, so we only send to GA the most specific event resolution
    if ((Date.now() - lastGaEventTime) > 150) {
      ga('send', 'event', 'UI', 'UI Element / ' + parentContainer, linkName);
      lastGaEventTime = Date.now();

      // conditional logging
      if (jQuery('body').hasClass('verbose-analytics')) {
        console.log('%c Verbose analytics on ', 'color: #FFF; background: #111; font-size: .75rem;');
        console.log('clicked on: %o ',actedOnItem);
        console.log('sent to GA: ', 'event ->', 'UI ->', 'UI Element / ' + parentContainer + ' ->', linkName, '; at: ',lastGaEventTime);
      }
    }
  } // END analyticsTrackInteraction

  // initialise the tracking of various areas
  function ebiGaInit() {
    // Only track these areas
    // This could be done more efficently with a general capture of links,
    // but we're running against the page's unload -- so speed over elegance.

    // Order these by specificity -- only the first invoked will be sent to GA
    jQuery("body.google-analytics-loaded .track-with-analytics-events a").on('mousedown', function(e) {
      analyticsTrackInteraction(e.target,'Manually tracked area');
    });
    jQuery("body.google-analytics-loaded .masthead-black-bar").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Black bar');
    });
    jQuery("body.google-analytics-loaded .masthead").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Masthead');
    });
    jQuery("body.google-analytics-loaded .related ul").on('mousedown', 'li > a', function(e) {
      analyticsTrackInteraction(e.target,'Popular');
    });
    jQuery("body.google-analytics-loaded .with-overlay").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Highlight box');
    });
    jQuery("body.google-analytics-loaded #global-footer").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Footer');
    });
    jQuery("body.google-analytics-loaded #global-search").on('mousedown', 'input', function(e) {
      analyticsTrackInteraction(e.target,'Global search');
    });
    jQuery("body.google-analytics-loaded #local-search").on('mousedown', 'input', function(e) {
      analyticsTrackInteraction(e.target,'Local search');
    });
    jQuery("body.google-analytics-loaded .analytics-content-intro, body.google-analytics-loaded .intro-unit").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Intro');
    });
    jQuery("body.google-analytics-loaded .analytics-content-sidebar").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Sidebar');
    });
    jQuery("body.google-analytics-loaded .analytics-content-left").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Left content');
    });
    jQuery("body.google-analytics-loaded .analytics-content-right").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Right content');
    });
    jQuery("body.google-analytics-loaded .analytics-content-footer").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Content footer');
    });

    // catch all -- should come last
    jQuery("body.google-analytics-loaded #main-content-area, body.google-analytics-loaded .analytics-content-main").on('mousedown', 'a', function(e) {
      analyticsTrackInteraction(e.target,'Main content');
    });

    // todo: homepage search return
    // $('textarea').bind("enterKey",function(e){
    //    //do stuff here
    // });
    // $('textarea').keyup(function(e){
    //     if(e.keyCode == 13)
    //     {
    //         $(this).trigger("enterKey");
    //     }
    // });

    // To do: track livefilter
    // input.filter[type="text"]').on("keyup", function() {

    // log control+f and command+f
    // base method via http://stackoverflow.com/a/6680403
    var keydown = null;
    if (jQuery('body').hasClass('google-analytics-loaded')) {
      jQuery(window).keydown(function(e) {
        // the user does ctrl+f action
        if ( ( e.keyCode == 70 && ( e.ctrlKey || e.metaKey ) ) ||
           ( e.keyCode == 191 ) ) {
          keydown = new Date().getTime();
        }
        return true;
      }).blur(function() {
        // and then browser window blurs, indicating shift to UI
        if ( keydown !== null ) {
          var delta = new Date().getTime() - keydown;
          if ( delta > 0 && delta < 1000 ) {
            ga('send', 'event', 'UI', 'UI Element / Keyboard', 'Browser in page search');
          }
          keydown = null;
        }
      });
    }
  } // END ebiGaInit


  // Foundation specific extensions of functionality
  // -------------
  (function($) {

    // Clearable text inputs
    // via: http://stackoverflow.com/questions/6258521/clear-icon-inside-input-text
    // -------------
    function tog(v){return v?'addClass':'removeClass';}
    $(document).on('input', '.clearable', function(){
      $(this)[tog(this.value)]('x');
    }).on('mousemove', '.x', function( e ){
      $(this)[tog(this.offsetWidth-25 < e.clientX-this.getBoundingClientRect().left)]('onX');
    }).on('touchstart click', '.onX', function( ev ){
      ev.preventDefault();
      $(this).removeClass('x onX').val('').change().keyup();
    });


    $.fn.foundationExtendEBI = function() {
      // Activate EMBL dropdown menu
      // Note: the menu content has already been added in script.js
      (function activateEMBLdropdown() {
        setTimeout(function() { // A small buffer incase scripts are loaded out of order
          try {
            var options = {closeOnClick: true},
                dropdownEbiMenu = new Foundation.Dropdown($('#embl-dropdown'), options);
          }
          catch(err) {};
        }, 200);
      })();

      // Focus searchbox on global nav button click
      // ---------
      // Ideally we would have used Foundation's "data-auto-focus", but this came after the HTML was widely circulated
      $('a[data-toggle="search-global-dropdown"]').click( function() {
        if($(this).is(':not(.hover)')) { setTimeout(function() { $('input#global-searchbox').focus() }, 100); }
      });

      // Link overlay images
      $(function() {
        $('.with-overlay').on('click',function(e) {
          var href = $(this).find('a:first').attr('href') || '';
          if (href.length > 0) {
            window.location.href = href;
          }
        })
      });

      // Responsive support for tables
      // ---------
      // Clone the class from a parent TH to any child TD
      $('table.responsive-table').each( function() {
        var columnsToAppend = $(this).find('th');
        for (var i = 0; i < columnsToAppend.length; i++) {
          if ($(columnsToAppend[i]).attr('class')) {
            var position = i + 1;
            $(this).find('td:nth-child('+position+')').addClass($(columnsToAppend[i]).attr('class'));
          }
        };
      });

      // Smooth scroll anchor links for jQuery users
      // -----------
      $(function() {
        $('a[href*=\\#]:not([href=\\#])').on('click', function() {
          // Table compatibility
          if ($(this).parent().parent().hasClass('tabs')) {
            return true; //exit
          }
          if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
            var target = $(this.hash),
                targetName = this.hash;
            target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
            if (target.length) {
              $('html,body').animate({
                scrollTop: target.offset().top - 40
              }, {
                duration: 1000,
                complete: function(){ window.location.hash = targetName; }
              });
              return false;
            }
          }
        });
      });

      // Create a dynamic height for the menu bar when stuck
      // -----------
      var desiredStuckMenuHeight = $('.masthead-inner').outerHeight() - $('.masthead-inner > nav > ul.menu').outerHeight();
      $("<style id='dynamic-stuck-height' type='text/css'> .masthead.sticky.is-stuck{ margin-top: -" + desiredStuckMenuHeight + "px !important;} </style>").appendTo("body");

      // Clone the local menu into a mobile-only menu
      // -----------
      var localMenuClass = '.masthead-inner > nav > ul.dropdown.menu.float-left';
      // var localMenuClass = '#secondary-menu-links'; // for testing
      // $(localMenuClass).addClass('dropdown'); // for testing
      var localMenuLeftPadding = parseInt($('.masthead-inner > nav ul').css('padding-left')); // account for padding of ul
      var localMenuWidthAvail = $('.masthead-inner > nav').innerWidth() - localMenuLeftPadding;

      function localNavSpilloverMenu(changeDirection) {
        var localMenuWidthUsed = 0; // Track how much space is occupied by the ul
        var localMenuRightSideWidth = $('.masthead-inner > nav ul.float-right.menu').outerWidth(); // width of any right-side nav, which would change on browser resize
        localMenuRightSideWidth = localMenuRightSideWidth + 1; // padding, eleminate NaN if it doesn't exsist

        // Calculate how much space we've used
        // We calculate each li and not the parent ul as some teams may make the ul 100% wide
        $(localMenuClass+' > li:not(".bug-fix-placeholder")').each( function() {
          localMenuWidthUsed = localMenuWidthUsed + $(this).outerWidth();
        });

        // Account for any float-right menu
        localMenuWidthUsed = localMenuWidthUsed + localMenuRightSideWidth;

        // Create dropdown if needed
        if ($(localMenuClass + ' li.extra-items-menu').length == 0) {
          // responsiveMenuSubMenuBugFix: see https://github.com/ebiwd/EBI-Framework/issues/50
          var responsiveMenuSubMenuBugFix = '<li class="bug-fix-placeholder" style="display:none !important;"><a href="#">A workaround</a> <ul class="menu"> <li><a href="#">for a bug where the dropdown menu fails sometimes unless there are two submenus in the submenu</a></li></ul>  </li>';
          $(localMenuClass).append('<li class="extra-items-menu" style="display:none;"><a href="#">Also in this section</a><ul class="menu">'+responsiveMenuSubMenuBugFix+'</ul></li>');
          // $(localMenuClass).append('<li class="extra-items-menu" style="display:none;"><a href="#">Also in this section</a><ul class="menu"></ul></li>');
          localMenuWidthUsed = localMenuWidthUsed + $(localMenuClass + ' > li.extra-items-menu').outerWidth(); // Account for width of li.extra-items-menu
          // invoke foundation to create dropdown functionality when we add the menu
          var options = {closeOnClickInside: false, closeOnClick: false}; // Prevent a bug in foundation 6.2.4 that prevents mobile clicking :(
          var responsiveMenu = new Foundation.DropdownMenu($(localMenuClass),options);
        }

        // Do we need to make space?
        if ( (changeDirection == 'init') || (changeDirection == 'decrease') ) {
          if (localMenuWidthUsed > localMenuWidthAvail) {
            // show dropdown, if hidden
            if ($(localMenuClass + ' li.extra-items-menu:visible').length == 0) {
              $(localMenuClass + ' li.extra-items-menu').show();
            }

            // loop through each menu item in reverse, and slice off the first as it's the dropdown
            $($(localMenuClass+' > li').get().reverse().slice(1)).each( function() {
              if (localMenuWidthUsed > localMenuWidthAvail) { // do we need to hide more items?
                localMenuWidthUsed = localMenuWidthUsed - $(this).outerWidth();
                $(this).detach().prependTo(localMenuClass + ' > li.extra-items-menu > ul.menu');
              } // we could break when <= but this should be pretty fast
            });
          }
        }

        if (changeDirection == 'increase') {

          // does the dropdown exist?
          if ($(localMenuClass + ' li.extra-items-menu:visible').length == 1) {

            // if the menu is shorter than full width, we can perhaps restore some menu items from the dropdown
            var spaceToWorkWith = localMenuWidthAvail - localMenuWidthUsed;

            // as the dropdown menu is the width of longest menu item, it's not practical to get the length of each,
            //   so if the longest item could fit, we'll restore an item
            var spaceRequiredForFirstHiddenChild =  $(localMenuClass+' > li.extra-items-menu > ul.menu > li:first-child').outerWidth();
            while (spaceToWorkWith > spaceRequiredForFirstHiddenChild) {
              spaceToWorkWith = spaceToWorkWith - spaceRequiredForFirstHiddenChild;
              $(localMenuClass+' > li.extra-items-menu > ul.menu > li:first-child').detach().insertBefore(localMenuClass+' li.extra-items-menu');
              if ($(localMenuClass + ' > li.extra-items-menu > ul.menu > li:not(".bug-fix-placeholder")').length == 0)  {
                // if the dropdown has no visible items, hide it
                $(localMenuClass + ' li.extra-items-menu').hide();
                break;
              }
            }

            // if there's no or just one item left, see if we should not count the width of the dropdown menu
            // if ($(localMenuClass + ' li.extra-items-menu > ul > li:not(".bug-fix-placeholder")').length == 1) {
            //   spaceToWorkWith = spaceToWorkWith + $(localMenuClass + ' > li.extra-items-menu').innerWidth();
            //   if (spaceToWorkWith > spaceRequiredForFirstHiddenChild) {
            //     // ok, we should move last item up from dropdwon, this will leave us with 0 items
            //     $(localMenuClass+' > li.extra-items-menu > ul.menu > li:first-child').detach().insertBefore(localMenuClass+' li.extra-items-menu');
            //     // if the dropdown has no visible items, hide it
            //     $(localMenuClass + ' li.extra-items-menu').hide();
            //   }
            // }
          }
        }
      }

      localNavSpilloverMenu('init');
      // re-calc menus on browser change, if it affect width of localMenuWidthAvail
      $(window).resize( function() {
        var snapshot_localMenuWidthAvail = $('.masthead-inner > nav').innerWidth();
        var widthChangeAmount = snapshot_localMenuWidthAvail - localMenuWidthAvail;
        if (widthChangeAmount != 0) localMenuWidthAvail = snapshot_localMenuWidthAvail;
        // we look for changes of more than 1 to reduce jitter
        if (widthChangeAmount > 1)  localNavSpilloverMenu('increase');
        if (widthChangeAmount < -1) localNavSpilloverMenu('decrease');
      });
    }
  }(jQuery));
  </script>
  <script type="text/JavaScript">$(document).foundation();</script>
  <script type="text/JavaScript">$(document).foundationExtendEBI();</script>

  <!-- Rather than use a full custom them stylesheet, inline the few we need. Saves an http request  -->
  <style type="text/css">
  a.button:hover, .button:hover {
    background: #007c82;
  }
  a.highlight-caption {
    z-index: 1; position: relative; top: -2rem; color: #fff; padding: .25rem .5rem;
    background: #333;
    border-bottom: none;
  }
  a.highlight-caption:hover {
    opacity: .8;
  }
  </style>
  <script type="text/javascript">
  // resize search dropdown on change
  // this way text doesn't get cut off
  $(document).ready(function(){
    $('#db').change(function(){
      if ($(this).find(":selected").text().length > 10) {
      $('div.search-options-wrapper').removeClass('small-2').addClass('small-4');
      $('div.search-text-wrapper').removeClass('small-8').addClass('small-6');
      } else {
        $('div.search-options-wrapper').removeClass('small-4').addClass('small-2');
        $('div.search-text-wrapper').removeClass('small-6').addClass('small-8');
      }
      $('input#query').attr('placeholder', 'Enter your search').focus();
      $('input#query').focus();
    });
  });
  </script>

</body>
</html>
